<!--
 * @Author: chenyuting
 * @Date: 2024-10-11 10:38:24
 * @LastEditors: chenyuting
 * @LastEditTime: 2024-12-10 09:57:37
 * @Description: 
-->
<!--
 * @Author: zhangxuefeng
 * @Date: 2024-07-08 16:17:22
 * @LastEditors: zhangxuefeng
 * @LastEditTime: 2024-07-08 17:01:09
 * @Description: 
-->
<!--
 * @Author: zhangxuefeng
 * @Date: 2024-07-08 16:17:22
 * @LastEditors: zhangxuefeng
 * @LastEditTime: 2024-07-08 16:26:05
 * @Description: 
-->
<app-page-header [pageHeaderInfo]="pageHeaderInfo"></app-page-header>

<div class="normal-table-wrap">
  <nz-card nzTitle="" class="m-b-10">
    <div nz-row [nzGutter]="24">
      <div
        nz-col
        nzXs="24"
        nzSm="24"
        nzXl="12"
        nzXXl="8"
        *ngFor="let item of bankNumberList; index as i"
      >
        <nz-card
          class="card base-card dashborad-card"
          [ngClass]="{
            'dashborad-image-1': i === 0,
            'dashborad-image-2': i === 1,
            'dashborad-image-3': i === 2
          }"
        >
          <div class="text-center m-t-10 m-b-10">
            <div class="m-b-10">
              <h3 nz-typography style="color: #fff">
                {{ item.bankType | map: 'dashBoradBankType' }}
              </h3>
            </div>
            <div class="m-t-10">
              <h2 nz-typography style="color: #fff">{{ item.bankNumber }}</h2>
            </div>
          </div>
        </nz-card>
      </div>
    </div>
    <!-- <div nz-row [nzGutter]="24" class="m-t-30">
      <div nz-col nzXs="24" nzSm="24" nzXl="12" nzXXl="12" *ngFor="let item of bankInfoList">
        <nz-card [nzTitle]="titleTemplate" [nzExtra]="extraTemplate" class="card base-card"
          style="background-color: #F4F9FD;height: 650px; overflow: auto;">
          <ng-template #titleTemplate>
            <h4 nz-typography>{{ item.centralBankName }}</h4>
          </ng-template>
          <ng-template #extraTemplate>
            <button nz-button nzType="primary" style="background-color: #f3e4be; color: #FFBD21;border: none;">{{
              item.currency }}</button>
          </ng-template> -->
    <!-- <div nz-row nzJustify="space-between" nzAlign="middle" class="m-t-10 m-b-10">
            <div>
              <h5 nz-typography>Number of commercial banks: {{ item.commercialBankNumber }}</h5>
            </div>
            <div>
              <h5 nz-typography>Number of sPs: {{ item.spBankNumber }}</h5>
            </div>
          </div> -->
    <!-- <div *ngFor="let items of item.outCommercialBankInformationSearches" class="m-t-30">
            <h5 nz-typography style="color: #3c5686;">{{ items.spName }}
            </h5>
            <nz-card class="card base-card">
              <div class="m-b-10">
                <h5 nz-typography>{{ 'Activated Currency' }} {{ '(' + items.currencyNumber + ')'
                  }}</h5>
              </div>
              <div nz-row [nzGutter]="24" class="m-t-25">
                <div nz-col nzXs="24" nzSm="24" nzXl="8" nzXXl="6">
                  <div class="m-t-10 m-b-10">
                    <div class="m-b-10">
                      <h5 nz-typography>{{ 'Currency Code:' }}</h5>
                    </div>
                    <div class="m-t-10">
                      <span nz-typography nzType="secondary">{{ 'Activated On:' }}</span>
                    </div>
                  </div>
                </div>
                <div nz-col nzXs="8" nzSm="8" nzXl="8" nzXXl="6" *ngFor="let currency of items.commercialBankWallets">
                  <div class="m-t-10 m-b-10">
                    <div class="m-b-10">
                      <h5 nz-typography>{{ currency.cbdcName }}</h5>
                    </div>
                    <div class="m-t-10">
                      <span nz-typography nzType="secondary">{{ currency.auditDate | map:'dateStamp' }}</span>
                    </div>

                  </div>
                </div>
              </div>
            </nz-card> -->
    <!-- <nz-card class="card base-card" *ngIf="items.bankType === 2">
              <div class="m-b-10">
                <h5 nz-typography>{{ 'Avallable Currency Pair' }} {{ '(' + items.rateNumber + ')'
                  }}</h5>
              </div>
              <div nz-row [nzGutter]="24" class="m-t-25">
                <div nz-col nzXs="24" nzSm="24" nzXl="12" nzXXl="6" *ngFor="let currencyPair of items.rateInfoList">
                  <div class="m-t-10 m-b-10">
                    <div class="m-b-10">
                      <span nz-typography nzType="secondary">{{ currencyPair.applicationFormRateCurrency + '->' +
                        currencyPair.applicationToRateCurrency }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </nz-card> -->
    <!-- </div>
        </nz-card>
      </div>
    </div> -->
    <!-- <div>
      <nz-card class="card base-card" style="background-color: #F4F9FD;" nzTitle="Liquidity Provider List">
        <app-ant-table (changePageSize)="changePageSize($event)" (changePageNum)="getDataList($event)"
          [tableConfig]="tableConfig" [tableData]="dataList">
        </app-ant-table>
        <ng-template #currencyTpl let-currencyList="currencyList">
          <ng-container *ngIf="currencyList">
            <span *ngFor="let item of currencyList">
              <span [title]="item">{{ item }}</span>
              <br>
            </span>
          </ng-container>
          <ng-container *ngIf="!currencyList">{{ '--' }}</ng-container>
        </ng-template>
        <ng-template #currencyPairTpl let-currencyPairList="currencyPairList">
          <ng-container *ngIf="currencyPairList">
            <span *ngFor="let items of currencyPairList">
              <span [title]="items">{{ items }}</span>
              <br>
            </span>
          </ng-container>
          <ng-container *ngIf="!currencyPairList">{{ '--' }}</ng-container>
        </ng-template>
      </nz-card>
    </div> -->
    <div
      nz-row
      id="chart-container"
      style="
        max-width: 2400px;
        height: 800px;
        margin-top: 20px;
        display: flex;
        justify-content: center;
      "
    ></div>
    <div class="m-t-25">
      <nz-card
        class="card base-card"
        [nzBodyStyle]="{ 'padding-bottom': '50px', 'padding-top': '50px' }"
        style="background-color: #f4f9fd"
        nzTitle="Settlement Transaction Volume In the Last 7 Days"
      >
        <form
          nz-form
          [formGroup]="volumeForm"
          nzLayout="vertical"
          class="m-l-50 m-b-50"
        >
          <div nzJustify="center" nzAlign="middle" class="m-b-10" nzGutter="8">
            <div nz-col nzXs="24" nzSm="18" nzXl="12" nzXXl="20">
              <div nz-row nzJustify="space-between" [nzGutter]="8">
                <div
                  nz-col
                  [nzXXl]="8"
                  [nzXl]="12"
                  [nzLg]="12"
                  [nzMd]="12"
                  [nzSm]="24"
                  [nzXs]="24"
                >
                  <nz-form-item>
                    <nz-form-label>Custodian Bank </nz-form-label>
                    <nz-form-control>
                      <nz-select
                        nzPlaceHolder=""
                        formControlName="centralBankCode"
                      >
                        <nz-option nzValue="" nzLabel="All"></nz-option>
                        <nz-option
                          *ngFor="let item of centralBankList"
                          [nzValue]="item.centralBankCode"
                          [nzLabel]="item.centralBankName"
                        >
                        </nz-option>
                      </nz-select>
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div
                  nz-col
                  [nzXXl]="8"
                  [nzXl]="12"
                  [nzLg]="12"
                  [nzMd]="12"
                  [nzSm]="24"
                  [nzXs]="24"
                >
                  <nz-form-item>
                    <nz-form-label>Commercial Bank</nz-form-label>
                    <nz-form-control>
                      <nz-select
                        nzPlaceHolder=""
                        formControlName="commercialBankCode"
                      >
                        <nz-option nzValue="" nzLabel="All"></nz-option>
                        <nz-option
                          *ngFor="let item of commercialBankList"
                          [nzValue]="item.commercialCode"
                          [nzLabel]="item.commercialName"
                        >
                        </nz-option>
                      </nz-select>
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div
                  nz-col
                  [nzXXl]="8"
                  [nzXl]="12"
                  [nzLg]="12"
                  [nzMd]="12"
                  [nzSm]="24"
                  [nzXs]="24"
                  class="text-right"
                >
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"></nz-form-label>
                    <nz-form-control>
                      <div nz-col [nzSpan]="24">
                        <button
                          nz-button
                          [nzType]="'primary'"
                          (click)="onQueryVolume()"
                        >
                          Query
                        </button>
                      </div>
                    </nz-form-control>
                  </nz-form-item>
                </div>
              </div>
            </div>
          </div>
        </form>
        <ngx-charts-bar-vertical-2d
          [view]="view"
          [gradient]="gradient"
          [xAxis]="showXAxis"
          [yAxis]="showYAxis"
          [legend]="showLegend"
          [showXAxisLabel]="showXAxisLabel"
          [showYAxisLabel]="showYAxisLabel"
          [xAxisLabel]="xAxisLabel1"
          [yAxisLabel]="yAxisLabel1"
          [results]="multi1"
          [customColors]="false"
        >
        </ngx-charts-bar-vertical-2d>
      </nz-card>
    </div>
    <div class="m-t-25">
      <nz-card
        class="card base-card"
        style="background-color: #f4f9fd"
        nzTitle="Exchange Rate Dynamics In the Last 7 days"
      >
        <form
          nz-form
          [formGroup]="rateForm"
          nzLayout="vertical"
          class="m-l-50 m-b-50"
        >
          <div nzJustify="center" nzAlign="middle" class="m-b-10" nzGutter="8">
            <div nz-col nzXs="24" nzSm="18" nzXl="12" nzXXl="20">
              <div nz-row nzJustify="space-between" [nzGutter]="8">
                <div
                  nz-col
                  [nzXXl]="8"
                  [nzXl]="12"
                  [nzLg]="12"
                  [nzMd]="12"
                  [nzSm]="24"
                  [nzXs]="24"
                >
                  <nz-form-item>
                    <nz-form-label>Liquidity Provider</nz-form-label>
                    <nz-form-control>
                      <nz-select nzPlaceHolder="" formControlName="spCode">
                        <nz-option
                          *ngFor="let item of rateCommercialBankList"
                          [nzValue]="item.spChainCode"
                          [nzLabel]="item.spName"
                        >
                        </nz-option>
                      </nz-select>
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div
                  nz-col
                  [nzXXl]="8"
                  [nzXl]="12"
                  [nzLg]="12"
                  [nzMd]="12"
                  [nzSm]="24"
                  [nzXs]="24"
                >
                  <nz-form-item>
                    <nz-form-label>Currency Pair</nz-form-label>
                    <nz-form-control>
                      <nz-select nzPlaceHolder="" formControlName="currency">
                        <nz-option
                          *ngFor="let item of rateCurrencyList"
                          [nzValue]="item.key"
                          [nzLabel]="
                            item.sourceCurrency + '->' + item.targetCurrency
                          "
                        >
                        </nz-option>
                      </nz-select>
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div
                  nz-col
                  [nzXXl]="8"
                  [nzXl]="12"
                  [nzLg]="12"
                  [nzMd]="12"
                  [nzSm]="24"
                  [nzXs]="24"
                  class="text-right"
                >
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"></nz-form-label>
                    <nz-form-control>
                      <div nz-col [nzSpan]="24">
                        <button
                          nz-button
                          [nzType]="'primary'"
                          (click)="onQueryRate()"
                        >
                          Query
                        </button>
                      </div>
                    </nz-form-control>
                  </nz-form-item>
                </div>
              </div>
            </div>
          </div>
        </form>
        <ngx-charts-line-chart
          [view]="view"
          [legend]="legend"
          [showXAxisLabel]="showXAxisLabel"
          [showYAxisLabel]="showYAxisLabel"
          [xAxis]="xAxis"
          [yAxis]="yAxis"
          [xAxisLabel]="xAxisLabel2"
          [yAxisLabel]="yAxisLabel2"
          [autoScale]="true"
          [timeline]="timeline"
          [results]="multi2"
        >
        </ngx-charts-line-chart>
      </nz-card>
    </div>
  </nz-card>
</div>
<div
  id="container"
  [class]="'ss' + mapBankInfo?.bankCode"
  style="padding: 12px; display: none;"
>
  <div *ngIf="mapBankInfo?.bankType !== 3">
    <div class="tooltip-title">
      <div>
        <img
          nz-image
          style="width: 40px; height: 40px"
          [nzSrc]="mapBankInfo?.logo"
          *ngIf="mapBankInfo?.logo"
          alt=""
        />
        <a
          class="m-l-5 font-bold"
          routerLink="/poc/poc-commercial-bank/commercial-bank/info"
          [queryParams]="{ spCode: mapBankInfo?.bankCode }"
          >{{ mapBankInfo?.bankName }}</a
        >
      </div>
      <div>{{ mapBankInfo?.currency }}</div>
    </div>
    <div nz-row [nzGutter]="24" class="m-t-10">
      <div nz-col nzSpan="24" class="card-style">
        <nz-card
          class="card base-card dashborad-card"
          style="text-align: center; color: #fff; background-color: #ff9160"
        >
          <div class="dashboard-flex">
            <div>{{ 'Domestic Commercial Wallets' }}</div>
            <div style="font-size: 20px; margin-left: 20px">
              {{ mapBankInfo?.domesticWalletsNumber | map: 'toThousandRate' }}
            </div>
          </div>
        </nz-card>
      </div>
    </div>
    <div nz-row [nzGutter]="24">
      <div nz-col nzSpan="24" class="card-style">
        <nz-card
          class="card base-card dashborad-card"
          style="text-align: center; color: #fff; background-color: #829efa"
        >
          <div class="dashboard-flex" style="margin-bottom: 10px">
            <div>{{ 'Foreign Commercial Wallets' }}</div>
            <div style="font-size: 20px; margin-left: 20px">
              {{ mapBankInfo?.foreignWalletsNumber | map: 'toThousandRate' }}
            </div>
          </div>
          <div style="border-top: 1px solid">
            <ng-container *ngIf="mapBankInfo?.foreignWalletsNumber">
              <div
                *ngFor="
                  let value of mapBankInfo?.commercialBankWallets;
                  index as i
                "
                style="margin-top: 10px"
              >
                <div class="dashboard-flex" style="margin-bottom: 10px">
                  <div>{{ value.cbdcName }}</div>
                  <div>
                    {{ value.walletNumber | map: 'toThousandRate' }}
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="!mapBankInfo?.foreignWalletsNumber">
              <nz-empty nzNotFoundImage="simple"></nz-empty>
            </ng-container>
          </div>
        </nz-card>
      </div>
    </div>
    <div nz-row [nzGutter]="24" *ngIf="mapBankInfo?.bankType === 2">
      <div nz-col nzSpan="24" class="card-style">
        <nz-card
          class="card base-card dashborad-card"
          style="text-align: center; color: #fff; background-color: #8060ff"
        >
          <div class="dashboard-flex" style="margin-bottom: 10px">
            <div>{{ 'Foreign Exchange Currency Pair' }}</div>
            <div style="font-size: 12px; margin-left: 20px">
              {{ 'FX Service Provider' }}
            </div>
          </div>
          <div style="border-top: 1px solid">
            <ng-container
              *ngIf="
                mapBankInfo?.exchangeCurrencyPairs &&
                mapBankInfo?.exchangeCurrencyPairs.length > 0
              "
            >
              <div nz-row [nzGutter]="24">
                <div
                  nz-col
                  nzSpan="8"
                  *ngFor="
                    let value of mapBankInfo?.exchangeCurrencyPairs;
                    index as i
                  "
                  style="margin-top: 10px"
                >
                  <div class="dashboard-flex">
                    <div>
                      {{ value.formRateCurrency + '->' + value.toRateCurrency }}
                    </div>
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container
              *ngIf="
                !mapBankInfo?.exchangeCurrencyPairs ||
                mapBankInfo?.exchangeCurrencyPairs.length <= 0
              "
            >
              <nz-empty nzNotFoundImage="simple"></nz-empty>
            </ng-container>
          </div>
        </nz-card>
      </div>
    </div>
  </div>
  <div *ngIf="mapBankInfo?.bankType === 3">
    <div class="tooltip-title">
      <div>
        <img
          nz-image
          style="width: 60px; height: 60px"
          [nzSrc]="mapBankInfo?.logo"
          *ngIf="mapBankInfo?.logo"
          alt=""
        />
        <a
          class="m-l-5 font-bold text-large"
          routerLink="/poc/poc-central-bank/central-bank-regist/info"
          [queryParams]="{ bankCode: mapBankInfo?.bankCode }"
          >{{ mapBankInfo?.bankName }}</a
        >
      </div>
      <div>{{ mapBankInfo?.currency }}</div>
    </div>
    <div nz-row [nzGutter]="24" class="m-t-10">
      <div nz-col nzXs="24" class="dashborad-table tbody-first">
        <nz-table #basicTable [nzData]="dataList" [nzShowPagination]="false">
          <thead>
            <tr>
              <th class="font-bold">Commercial Bank</th>
              <!-- <th class="font-bold">Custodian Bank</th> -->
              <th class="font-bold">Currency</th>
              <th class="font-bold">Number of wallets</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let data of basicTable.data; index as index">
              <td
                class="dashborad-border"
                [ngClass]="{
                  'dashborad-bottm dashborad-table-firsts':
                    index === dataList.length - 1,
                  'dashborad-table-first': index === 0
                }"
              >
                <a
                  routerLink="/poc/poc-commercial-bank/commercial-bank/info"
                  [queryParams]="{ spCode: data.spCode }" [title]="data.spName"
                  >{{ data.spName.length > 20 ?  data.spName.slice(0, 20) + '...' : data.spName}}</a
                >
              </td>
              <!-- <td
                class="dashborad-border"
                [ngClass]="{ 'dashborad-bottm': index === dataList.length - 1 }"
              >
                {{ mapBankInfo?.bankName }}
              </td> -->
              <ng-container *ngIf="data.commercialBankWallets.length === 1">
                <td
                  class="dashborad-border"
                  [ngClass]="{
                    'dashborad-bottm': index === dataList.length - 1
                  }"
                  style="background-color: #D6C6DB"
                >
                  {{ data.commercialBankWallets[0].cbdcName }}
                </td>
                <td
                  class="dashborad-border font-bold"
                  [ngClass]="{
                    'dashborad-bottm dashborad-table-lasts': index === dataList.length - 1
                  }"
                  style="background-color: #D6C6DB; color: #6D1464;"
                >
                  {{
                    data.commercialBankWallets[0].walletNumber
                      | map: 'toThousandRate'
                  }}
                </td>
              </ng-container>
              <ng-container *ngIf="data.commercialBankWallets.length !== 1">
                <td
                  class="dashborad-border"
                  [ngClass]="{
                    'dashborad-bottm': index === dataList.length - 1
                  }"
                  style="padding: 0"
                >
                  <ng-container
                    *ngIf="
                      data.commercialBankWallets &&
                      data.commercialBankWallets.length > 0
                    "
                  >
                    <div
                      *ngFor="
                        let item of data.commercialBankWallets;
                        index as i
                      "
                      [ngStyle]="{
                        'background-color': i === 0 ? '#D6C6DB' : ''
                      }"
                      [ngClass]="{
                        'dashborad-bottm':
                          i !== data.commercialBankWallets.length - 1
                      }"
                      style="padding: 10px 0 10px 16px"
                    >
                      <span>{{ item.cbdcName }}</span>
                      <br />
                    </div>
                  </ng-container>
                  <ng-container
                    *ngIf="
                      !data.commercialBankWallets ||
                      data.commercialBankWallets.length <= 0
                    "
                  >
                    <div style="padding: 10px 0 10px 16px">
                      <span>{{ '--' }}</span>
                    </div>
                  </ng-container>
                </td>
                <td
                  class="dashborad-border"
                  [ngClass]="{
                    'dashborad-bottm dashborad-table-lasts':
                      index === dataList.length - 1,
                    'dashborad-table-last': index === 0
                  }"
                  style="padding: 0; border-right: 1px solid #99c5f0"
                >
                  <ng-container
                    *ngIf="
                      data.commercialBankWallets &&
                      data.commercialBankWallets.length > 0
                    "
                  >
                    <div
                      *ngFor="
                        let item of data.commercialBankWallets;
                        index as i
                      "
                      [ngStyle]="{
                        'background-color': i === 0 ? '#D6C6DB' : '',
                        color: i === 0 ? '#6D1464' : '#204C7D',
                        'border-top-right-radius': index === 0 ? '20px' : ''
                      }"
                      [ngClass]="{
                        'dashborad-bottm':
                          i !== data.commercialBankWallets.length - 1
                      }"
                      style="padding: 10px 0 10px 16px"
                    >
                      <span class="font-bold">{{
                        item.walletNumber | map: 'toThousandRate'
                      }}</span>
                      <br />
                    </div>
                  </ng-container>
                  <ng-container
                    *ngIf="
                      data.commercialBankWallets &&
                      data.commercialBankWallets.length <= 0
                    "
                  >
                    <div style="padding: 10px 0 10px 16px">
                      <span>{{ '--' }}</span>
                    </div>
                  </ng-container>
                </td>
              </ng-container>
            </tr>
          </tbody>
        </nz-table>
      </div>
    </div>
  </div>
</div>
